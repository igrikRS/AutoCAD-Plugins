# Назначение программы
Создание листов по рамкам, указанным пользователем в модели, либо автоматическое создание листов по вхождениям заданных блоков. 
Выбор формата бумаги и настройка листов производится автоматически.

[Карта действия программы](http://mind42.com/mindmap/941c4e75-f2c4-4743-864a-59fb15820f95?rel=url)

## Использование: 
### Для пользователя доступно 3 команды

**igrikCreateLayoutsFrames**
>Ручной выбор каждого формата листа с указанием 2х угловых точек и масштаба. 
[Видеоинструкция](https://www.youtube.com/watch?v=BsCouHhkMyI)

**igrikCreateLayoutsSelect**
>Ручной выбор каждого блока или рамки-СПДС. Масштаб определяется автоматически. 
[Видеоинструкция](https://youtu.be/QwTcPV1HtXE)

**igrikCreateLayoutsAuto**
>Автоматическое создание листов по всем блокам на чертеже с сортировкой их по номеру листа. 
[Видеоинструкция](https://youtu.be/AQxPH2vl6Ms)

## Конфигурация:
![](https://i.ibb.co/LNd2RDb/LFMScreen.png)
### Файл конфигурации. Имя файла - lfmsettings.xml. Всегда хранится рядом с программой

**Префикс** 
>Префикс имени создаваемого листа.

**Суффикс**
>Суффикс имени создаваемого листа.

**Точность определения форматов**
>Отвечает за точность определения форматов. Суть в том, что форматки иногда бывают примерно  по госту. Таким образом, если указываемая форматка больше гостовского размера (уже после скалирования) на указанный размер - будет выбран соответствующий формат бумаги. Значение - целое число. По умолчанию = 10 мм

**Удалять неинициализированые листы**
>Удалять ли листы, на которые ни разу не заходил пользователь.

**Оставаться в модели по окончании работы**
>Возвращать ли пользователя в модель по окончании работы программы.

**Имя блока-рамки**
>Название блока, по которому будет производиться автоматический поиск всех блоков с данным именем в пространстве модели, и с последующей сортировкой по имени тега (см.ниже) и созданием листов. Необходим только для команды "igrikCreateLayoutsAuto". Важно! Блоки на "непечатаемых слоях" будут проигнорированны и для них листы создаваться не будут.

**Имя тега в блоке**
>Название тега в блоке, по которому будет производиться сортировка создаваемых листов. Необходим только для команды "igrikCreateLayoutsAuto". Важно! Блоки с пустым тегом будут проигнорированны и для них листы создаваться не будут.

**Имя тега в блоке**
>Название тега в блоке, по которому будет производиться сортировка создаваемых листов. Необходим только для команды "igrikCreateLayoutsAuto". Важно! Блоки с пустым тегом будут проигнорированны и для них листы создаваться не будут.

**Коэффициент масштаба для блоков**
>Этот коэффициент необходим для правильного вывода блок-рамок на листы, вычерченных в пространстве модели не в масштабе 1:1. В подавляющем большинстве случаев необходимо оставить значение по умолчанию равное "1".

## Опции ком. строки:
**Undo**
>Отменить выбор последней рамки.

**Newscale**
>Задать новый масштаб рамки.

**Process**
>Выполнить создание листов.

**Configuration**
>Вызвать диалог конфигурации.

**templateSelect**
>Выбрать шаблонный файл. Переменная FILEDIA влияет на вид запроса (можно использовать в макросах).

## При работе с блоками есть 2 важных нюанса:
> Автоматическое создание листов игнорирует блоки на "непечатаемых слоях" и "блок-рамки без номера листа (атрибут в блоке)".

> Ограничения с блоками: следите, чтобы динамические параметры и атрибуты НЕ вылезали за пределы геометрии блока! Иначе рамки будут создаваться большего размера, а значит не правильно.


## Принцип работы:
### Программа формирует предварительный список настроек листа, с форматами бумаги. Список формируется двумя способами:
**Из файла шаблона (рекомендуемый)**
Копируются пользовательские именованные настройки печати, доступные из диалога "Page setup".
Имя настройки печати не должно начинаться с символа звёздочки "*"
Файлы шаблона и настроек плоттеров прилагаются.

**Из DWG to PDF.pc3**
Выбираются все пользовательские форматы.
В конец списка добавляются форматы, начинающиеся на "ISO A.."
Область печати выставляется "Лист"
Единицы измерения - миллиметры
Масштаб 1:1
Стиль печати - acad.ctb. Позже буду брать из файла конфигурации
Имя настройки берётся из имени формата бумаги. Если встречаются символы из ряда "\<>/?"":;*|,=`" - убираются


## Обратная связь:
По вопросам данного плагина связаться со мной можно на форуме [dwg.ru](https://forum.dwg.ru/showthread.php?t=83750)